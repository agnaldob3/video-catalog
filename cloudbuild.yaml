steps:

  -   id: "Rodando docker-compose"
      name: 'gcr.io/$PROJECT_ID/docker-compose:1.24.0'
      args: ['-f','docker-compose.cloudbuild.yaml','up','-d']

  -   id: "Rodando docker ps"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'ps' ]

  -   id: "Chown in /var/www"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec','-u','root','-t','micro-videos-app','chown','-R','www-data:www-data','/var/www' ]

  -   id: "Chown 777 bootstrap/cache"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec','-u','root','-t','micro-videos-app','chown','-R','777','/var/www/bootstrap' ]

  -   id: "Rodando composer"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','composer','update' ]

  -   id: "Copiando .env"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','cp','.env.example','.env']

  -   id: "Rodando key:generate"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','php','/var/www/artisan','key:generate' ]

  -   id: "Limpando cache"
        name: 'gcr.io/cloud-builders/docker'
        args: [ 'exec', '-t', 'micro-videos-app','php','/var/www/artisan','cache:clear' ]

  - id: "Configurando cach"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','php','/var/www/artisan','config:cach' ]

  -   id: "Rodando migrations"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','php','/var/www/artisan','migrate' ]

  -   id: "Rodando phpunit"
      name: 'gcr.io/cloud-builders/docker'
      args: [ 'exec', '-t', 'micro-videos-app','php','/var/www/vendor/bin/phpunit','-c','/var/www/phpunit.xml']
